<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SunDevil Outpost - Marketplace</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/example_app_page.css') }}">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-asu-maroon">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <img src="../static/images/asufork.png" alt="Sparky" class="nav-logo me-2">
                SunDevil Outpost
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" onclick="showBrowse()">
                            <i class="fas fa-store me-1"></i> Browse
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showYourListings()">
                            <i class="fas fa-box me-1"></i> Your Listings
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="fas fa-heart me-1"></i> Saved</a>
                    </li>
                </ul>
                <div class="d-flex gap-2">
                    <button class="btn btn-asu-gold" onclick="openNewListingModal()">
                        <i class="fas fa-plus me-1"></i> Create Listing
                    </button>
                    <div class="dropdown">
                        <button class="btn btn-outline-light dropdown-toggle" type="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-circle me-1"></i> Account
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="#"><i class="fas fa-user me-2"></i>Profile</a></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>Settings</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item text-danger" href="#"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-4">
        <!-- Search and Filters -->
        <div class="search-section bg-white rounded shadow-sm p-3 mb-4">
            <div class="row g-3">
                <div class="col-md-6">
                    <div class="input-group">
                        <span class="input-group-text bg-transparent">
                            <i class="fas fa-search"></i>
                        </span>
                        <input type="text" class="form-control" placeholder="Search items...">
                    </div>
                </div>
                <div class="col-md-3">
                    <select class="form-select">
                        <option value="">All Campuses</option>
                        <option>Tempe</option>
                        <option>Downtown Phoenix</option>
                        <option>Polytechnic</option>
                        <option>West</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <select class="form-select">
                        <option value="">All Categories</option>
                        <option>Textbooks</option>
                        <option>Electronics</option>
                        <option>Furniture</option>
                        <option>Housing</option>
                        <option>School Supplies</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Quick Filters -->
        <div class="quick-filters mb-4">
            <button class="btn btn-filter active">All Items</button>
            <button class="btn btn-filter">Textbooks</button>
            <button class="btn btn-filter">Electronics</button>
            <button class="btn btn-filter">Furniture</button>
            <button class="btn btn-filter">Housing</button>
            <button class="btn btn-filter">School Supplies</button>
        </div>

        <!-- Listings Grid -->
        <div class="row g-4">
            <!-- Sample Listing Cards -->
            <div class="col-md-6 col-lg-4 col-xl-3">
                <div class="card listing-card h-100">
                    <img src="{{ url_for('static', filename='images/placeholder.jpg') }}" class="card-img-top listing-img" alt="Product">
                    <div class="card-body">
                        <h5 class="card-title text-truncate">Calculus Textbook</h5>
                        <p class="card-text price-text">$65</p>
                        <p class="card-text description-text text-muted">Like new, includes online access code</p>
                        <div class="location-badge">
                            <i class="fas fa-map-marker-alt"></i>
                            Tempe Campus
                        </div>
                    </div>
                    <div class="card-footer bg-transparent">
                        <small class="text-muted">Posted 2 days ago</small>
                    </div>
                </div>
            </div>
            <!-- More listing cards will be added dynamically -->
        </div>
    </div>

    <!-- New Listing Modal -->
    <div class="modal fade" id="newListingModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-asu-maroon text-white">
                    <h5 class="modal-title">
                        <i class="fas fa-plus-circle me-2"></i>
                        Create New Listing
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="newListingForm">
                        <div class="mb-3">
                            <label class="form-label">Title</label>
                            <input type="text" class="form-control" id="title" name="title" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Price ($)</label>
                            <input type="number" class="form-control" id="price" name="price" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Category</label>
                            <select class="form-select" id="category" name="category" required>
                                <option value="">Select a category...</option>
                                <option>Textbooks</option>
                                <option>Electronics</option>
                                <option>Furniture</option>
                                <option>Housing</option>
                                <option>School Supplies</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Campus</label>
                            <select class="form-select" id="campus" name="campus" required>
                                <option value="">Select campus...</option>
                                <option>Tempe</option>
                                <option>Downtown Phoenix</option>
                                <option>Polytechnic</option>
                                <option>West</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" rows="3" id="description" name="description" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Images</label>
                            <input type="file" class="form-control" name="images" multiple accept="image/*">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" form="newListingForm" class="btn btn-asu-maroon">
                        <i class="fas fa-plus me-1"></i> Create Listing
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Expanded View Modal -->
<div class="modal fade" id="expandedViewModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-asu-maroon text-white">
                <h5 class="modal-title" id="expandedModalTitle"></h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <img id="expandedModalImage" class="img-fluid mb-3" alt="Listing Image">
                <p id="expandedModalPrice" class="price-text fs-4"></p>
                <p id="expandedModalDescription"></p>
                <p id="expandedModalLocation" class="text-muted"><i class="fas fa-map-marker-alt"></i> <span></span></p>
            </div>
            <div class="modal-footer justify-content-end">
                <button class="btn btn-outline-primary">
                    <i class="fas fa-envelope me-1"></i> Message Seller
                </button>
                <button class="btn btn-asu-gold">
                    <i class="fas fa-shopping-cart me-1"></i> Purchase
                </button>
            </div>
        </div>
        <div class="messaging-section mt-4" style="display: none;">
            <hr>
            <h5>Message Seller</h5>
            <div class="messages-container mb-3" style="max-height: 200px; overflow-y: auto;">
                <!-- Messages will be populated here -->
            </div>
            <div class="input-group">
                <input type="text" class="form-control" id="messageInput" placeholder="Type your message...">
                <button class="btn btn-primary" type="button" onclick="sendMessage()">Send</button>
            </div>
        </div>
    </div>
</div>

<!-- Edit Listing Modal -->
<div id="editListingModal" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header bg-asu-maroon text-white">
                <h5 class="modal-title">Edit Listing</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="editListingTitle" class="form-label">Title</label>
                        <input type="text" class="form-control" id="editListingTitle" name="title" required>
                    </div>

                    <div class="mb-3">
                        <label for="editListingPrice" class="form-label">Price ($)</label>
                        <input type="number" class="form-control" id="editListingPrice" name="price" step="0.01" required>
                    </div>

                    <div class="mb-3">
                        <label for="editListingCategory" class="form-label">Category</label>
                        <select class="form-select" id="editListingCategory" name="category" required>
                            <option value="">Select a category...</option>
                            <option value="Textbooks">Textbooks</option>
                            <option value="Electronics">Electronics</option>
                            <option value="Furniture">Furniture</option>
                            <option value="Housing">Housing</option>
                            <option value="School Supplies">School Supplies</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label for="editListingCampus" class="form-label">Campus</label>
                        <select class="form-select" id="editListingCampus" name="campus" required>
                            <option value="">Select campus...</option>
                            <option value="Tempe">Tempe</option>
                            <option value="Downtown Phoenix">Downtown Phoenix</option>
                            <option value="Polytechnic">Polytechnic</option>
                            <option value="West">West</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label for="editListingDescription" class="form-label">Description</label>
                        <textarea class="form-control" id="editListingDescription" name="description" rows="3" required></textarea>
                    </div>

                    <div class="mb-3">
                        <label for="editListingImage" class="form-label">Image URL</label>
                        <input type="url" class="form-control" id="editListingImage" name="image_url">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-asu-gold">Save Changes</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="purchaseModal" class="modal fade" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-asu-maroon text-white">
                <h5 class="modal-title">Complete Your Purchase</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <div class="modal-body">
                <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" id="inPersonPickupCheckbox">
                    <label class="form-check-label" for="inPersonPickupCheckbox">
                        In-Person Pickup (No Shipping Required)
                    </label>
                </div>

                <div id="purchaseAccordion" class="accordion">
                    <!-- Shipping Information Section -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingShipping">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseShipping">
                                Shipping Information
                            </button>
                        </h2>
                        <div id="collapseShipping" class="accordion-collapse collapse show" data-bs-parent="#purchaseAccordion">
                            <div class="accordion-body">
                                <form id="shippingForm" class="row g-3">
                                    <div class="col-md-6">
                                        <label for="firstName" class="form-label">First Name *</label>
                                        <input type="text" class="form-control" id="firstName" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="lastName" class="form-label">Last Name *</label>
                                        <input type="text" class="form-control" id="lastName" required>
                                    </div>
                                    <div class="col-md-12">
                                        <label for="address1" class="form-label">Street Address 1 *</label>
                                        <input type="text" class="form-control" id="address1" required>
                                    </div>
                                    <div class="col-md-12">
                                        <label for="address2" class="form-label">Street Address 2</label>
                                        <input type="text" class="form-control" id="address2">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="city" class="form-label">City *</label>
                                        <input type="text" class="form-control" id="city" required>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="state" class="form-label">State *</label>
                                        <select class="form-select" id="state" required>
                                            <option value="">Choose...</option>
                                            <option value="AZ">Arizona</option>
                                            <!-- Add other states as needed -->
                                        </select>
                                    </div>
                                    <div class="col-md-2">
                                        <label for="zipCode" class="form-label">Zip Code *</label>
                                        <input type="text" class="form-control" id="zipCode" pattern="[0-9]{5}" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="email" class="form-label">Email *</label>
                                        <input type="email" class="form-control" id="email" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="confirmEmail" class="form-label">Confirm Email *</label>
                                        <input type="email" class="form-control" id="confirmEmail" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="phone" class="form-label">Phone Number *</label>
                                        <input type="tel" class="form-control" id="phone" pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}" 
                                               placeholder="XXX-XXX-XXXX" required>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Payment Section -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingPayment">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePayment">
                                Pay With
                            </button>
                        </h2>
                        <div id="collapsePayment" class="accordion-collapse collapse" data-bs-parent="#purchaseAccordion">
                            <div class="accordion-body">
                                <form id="paymentForm" class="row g-3">
                                    <div class="col-md-12">
                                        <label for="cardNumber" class="form-label">Card Number *</label>
                                        <input type="text" class="form-control" id="cardNumber" pattern="[0-9]{4} [0-9]{4} [0-9]{4} [0-9]{4}"
                                               placeholder="XXXX XXXX XXXX XXXX" maxlength="19" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="expirationDate" class="form-label">Expiration Date *</label>
                                        <input type="text" class="form-control" id="expirationDate" pattern="(0[1-9]|1[0-2])\/[0-9]{2}"
                                               placeholder="MM/YY" maxlength="5" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="securityCode" class="form-label">Security Code *</label>
                                        <input type="text" class="form-control" id="securityCode" pattern="[0-9]{3}"
                                               placeholder="XXX" maxlength="3" required>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-asu-gold" onclick="submitPurchase()">Confirm Purchase</button>
            </div>
        </div>
    </div>
</div>

   <!-- At the bottom of your HTML, before closing </body> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.js"></script>
<script src="{{ url_for('static', filename='js/datamodel.js') }}"></script>
<script src="{{ url_for('static', filename='js/chatsocket.js') }}"></script>
<script src="{{ url_for('static', filename='js/example_app_page.js') }}"></script>
</body>
</html>